import{r as i,u as h,j as e,I as y,B as I,c as _,h as B,d as D,e as p,f as b,i as M,k as T,l as A,m as E}from"./index-1Mlb42wc.js";const v=s=>s.chat.phoneNumber,H=s=>s.chat.notifications,R="_wrapper_e96ev_1",L="_container_e96ev_7",x={wrapper:R,container:L},P="_wrapper_1ya88_1",F="_input_1ya88_6",N={wrapper:P,input:F},G=()=>{const s=h(),[t,a]=i.useState(""),n=()=>{s(_.setPhoneNumber(t))};return e.jsxs("div",{className:N.wrapper,children:[e.jsx(y,{onChange:a,className:N.input}),e.jsx(I,{onClick:n,children:"Start"})]})},z=i.memo(G),O="_wrapper_uvr47_1",Q={wrapper:O},U="_wrapper_1ni1t_1",q="_incoming_1ni1t_7",J="_outcoming_1ni1t_13",K="_time_1ni1t_19",r={wrapper:U,incoming:q,outcoming:J,time:K},j=({data:s})=>{const t=s.type===B.incoming;return e.jsxs("div",{className:D(r.wrapper,t?r.incoming:r.outcoming),children:[e.jsx("div",{className:r.message,children:s.textMessage}),e.jsx("div",{className:r.time,children:s.formattedTime})]})},V=3e3,W=()=>{const s=h(),t=i.useRef(null),a=p(b),n=p(v),c=p(H),l=!(a.idInstance&&a.apiTokenInstance&&n),[d,{isLoading:g}]=M(),{data:u=[]}=T({...a,phoneNumber:n},{skip:l}),f=l||g,{data:o,isFetching:w,isUninitialized:C,refetch:$}=A({...a,phoneNumber:n},{skip:f,refetchOnFocus:!0,pollingInterval:V}),k=async m=>{await d({...a,id:m}).unwrap(),$()};return i.useEffect(()=>{if(!C&&!w&&o){const m=o.receiptId;s(_.setNotification(o)),m&&k(m);return}},[o]),i.useEffect(()=>{t.current&&t.current.scrollTo(0,t.current.scrollHeight)},[c,u]),{chatHistory:u,notifications:c,isFetching:w,chatRef:t}},X=()=>{const{chatHistory:s,notifications:t,chatRef:a}=W();return e.jsxs("div",{className:Q.wrapper,ref:a,children:[s.map(n=>e.jsx(j,{data:n},n.idMessage)),t.map(n=>e.jsx(j,{data:n},n.idMessage))]})},Y="_wrapper_r4dm0_1",Z="_input_r4dm0_7",S={wrapper:Y,input:Z},ee=()=>{const s=h(),t=p(b),a=p(v),[n,c]=i.useState(""),[l,{isLoading:d}]=E(),g=!(t.idInstance&&t.apiTokenInstance&&n.trim())||d,u=()=>{c("")};return{message:n,isDisabled:g,setMessage:c,onSubmit:async()=>{const o=await l({idInstance:t.idInstance,apiTokenInstance:t.apiTokenInstance,phoneNumber:a,message:n}).unwrap();s(_.setNotification(o)),u()}}},se=()=>{const{message:s,setMessage:t,onSubmit:a,isDisabled:n}=ee();return e.jsxs("div",{className:S.wrapper,children:[e.jsx(y,{onChange:t,value:s,className:S.input}),e.jsx(I,{onClick:a,disabled:n,children:"Send"})]})},te="_wrapper_sblll_1",ne={wrapper:te},ae=()=>e.jsxs("div",{className:ne.wrapper,children:[e.jsx(z,{}),e.jsx(X,{}),e.jsx(se,{})]}),ie=()=>e.jsx("div",{className:x.wrapper,children:e.jsx("div",{className:x.container,children:e.jsx(ae,{})})});export{ie as default};
